/*! 
 Build based on gin-vue-admin 
 Time : 1654836743000 */
var e=(e,a,l)=>new Promise(((t,o)=>{var i=e=>{try{s(l.next(e))}catch(a){o(a)}},u=e=>{try{s(l.throw(e))}catch(a){o(a)}},s=e=>e.done?t(e.value):Promise.resolve(e.value).then(i,u);s((l=l.apply(e,a)).next())}));import{s as a,r as l,b as t,o,c as i,e as u,d as s,w as n,t as r,y as d,h as m,i as c}from"../gva/gin-vue-admin-index.1654836743000.js";import{W as v}from"./gin-vue-admin-warningBar.1654836743000.js";import{f as p}from"./gin-vue-admin-format.1654836743000.js";import"./gin-vue-admin-date.1654836743000.js";import"./gin-vue-admin-dictionary.1654836743000.js";import"./gin-vue-admin-sysDictionary.1654836743000.js";const f=e=>a({url:"/customer/customer",method:"post",data:e}),g={class:"gva-table-box"},h={class:"gva-btn-list"},b=m("新增"),y=m("变更"),w=s("p",null,"确定要删除吗？",-1),C={style:{"text-align":"right","margin-top":"8px"}},_=m("取消"),k=m("确定"),z=m("删除"),x={class:"gva-pagination"},D={class:"dialog-footer"},V=m("取 消"),j=m("确 定"),I={name:"Customer"},P=Object.assign(I,{setup(m){const I=l({customerName:"",customerPhoneData:""}),P=l(1),U=l(0),N=l(10),S=l([]),A=e=>{N.value=e,L()},B=e=>{P.value=e,L()},L=()=>e(this,null,(function*(){const e=yield(l={page:P.value,pageSize:N.value},a({url:"/customer/customerList",method:"get",params:l}));var l;0===e.code&&(S.value=e.data.list,U.value=e.data.total,P.value=e.data.page,N.value=e.data.pageSize)}));L();const O=l(!1),T=l(""),W=l=>e(this,null,(function*(){const e=yield(t={ID:l.ID},a({url:"/customer/customer",method:"get",params:t}));var t;T.value="update",0===e.code&&(I.value=e.data.customer,O.value=!0)})),q=()=>{O.value=!1,I.value={customerName:"",customerPhoneData:""}},E=l=>e(this,null,(function*(){l.visible=!1;var e;0===(yield(e={ID:l.ID},a({url:"/customer/customer",method:"delete",data:e}))).code&&(c({type:"success",message:"删除成功"}),1===S.value.length&&P.value>1&&P.value--,L())})),F=()=>e(this,null,(function*(){let e;switch(T.value){case"create":default:e=yield f(I.value);break;case"update":e=yield(l=I.value,a({url:"/customer/customer",method:"put",data:l}))}var l;0===e.code&&(q(),L())})),G=()=>{T.value="create",O.value=!0};return(e,a)=>{const l=t("el-button"),m=t("el-table-column"),c=t("el-popover"),f=t("el-table"),L=t("el-pagination"),T=t("el-input"),H=t("el-form-item"),J=t("el-form"),K=t("el-dialog");return o(),i("div",null,[u(v,{title:"在资源权限中将此角色的资源权限清空 或者不包含创建者的角色 即可屏蔽此客户资源的显示"}),s("div",g,[s("div",h,[u(l,{size:"small",type:"primary",icon:"plus",onClick:G},{default:n((()=>[b])),_:1})]),u(f,{ref:"multipleTable",data:S.value,style:{width:"100%"},"tooltip-effect":"dark","row-key":"ID"},{default:n((()=>[u(m,{type:"selection",width:"55"}),u(m,{align:"left",label:"接入日期",width:"180"},{default:n((e=>[s("span",null,r(d(p)(e.row.CreatedAt)),1)])),_:1}),u(m,{align:"left",label:"姓名",prop:"customerName",width:"120"}),u(m,{align:"left",label:"电话",prop:"customerPhoneData",width:"120"}),u(m,{align:"left",label:"接入人ID",prop:"sysUserId",width:"120"}),u(m,{align:"left",label:"按钮组","min-width":"160"},{default:n((e=>[u(l,{size:"small",type:"text",icon:"edit",onClick:a=>W(e.row)},{default:n((()=>[y])),_:2},1032,["onClick"]),u(c,{visible:e.row.visible,"onUpdate:visible":a=>e.row.visible=a,placement:"top",width:"160"},{reference:n((()=>[u(l,{type:"text",icon:"delete",size:"small",onClick:a=>e.row.visible=!0},{default:n((()=>[z])),_:2},1032,["onClick"])])),default:n((()=>[w,s("div",C,[u(l,{size:"small",type:"text",onClick:a=>e.row.visible=!1},{default:n((()=>[_])),_:2},1032,["onClick"]),u(l,{type:"primary",size:"small",onClick:a=>E(e.row)},{default:n((()=>[k])),_:2},1032,["onClick"])])])),_:2},1032,["visible","onUpdate:visible"])])),_:1})])),_:1},8,["data"]),s("div",x,[u(L,{"current-page":P.value,"page-size":N.value,"page-sizes":[10,30,50,100],total:U.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:B,onSizeChange:A},null,8,["current-page","page-size","total"])])]),u(K,{modelValue:O.value,"onUpdate:modelValue":a[2]||(a[2]=e=>O.value=e),"before-close":q,title:"客户"},{footer:n((()=>[s("div",D,[u(l,{size:"small",onClick:q},{default:n((()=>[V])),_:1}),u(l,{size:"small",type:"primary",onClick:F},{default:n((()=>[j])),_:1})])])),default:n((()=>[u(J,{inline:!0,model:I.value,"label-width":"80px"},{default:n((()=>[u(H,{label:"客户名"},{default:n((()=>[u(T,{modelValue:I.value.customerName,"onUpdate:modelValue":a[0]||(a[0]=e=>I.value.customerName=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),u(H,{label:"客户电话"},{default:n((()=>[u(T,{modelValue:I.value.customerPhoneData,"onUpdate:modelValue":a[1]||(a[1]=e=>I.value.customerPhoneData=e),autocomplete:"off"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])])}}});export{P as default};
