/*! 
 Build based on gin-vue-admin 
 Time : 1654836743000 */
var e=Object.defineProperty,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,n=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,r=(e,a,l)=>new Promise(((t,n)=>{var r=e=>{try{i(l.next(e))}catch(a){n(a)}},o=e=>{try{i(l.throw(e))}catch(a){n(a)}},i=e=>e.done?t(e.value):Promise.resolve(e.value).then(r,o);i((l=l.apply(e,a)).next())}));import{_ as o,U as i,g as u,e as s}from"./gin-vue-admin-common.1654836743000.js";import{W as m}from"./gin-vue-admin-warningBar.1654836743000.js";import{r as c,b as d,o as p,q as v,w as g,e as y,d as f,c as b,z as h,t as x,F as w,h as C,X as _,i as j}from"../gva/gin-vue-admin-index.1654836743000.js";const k={class:"gva-btn-list"},z=C("查询"),O={class:"media"},S={class:"header-img-box-list"},U={class:"header-img-box-list"},V=f("picture",null,null,-1),P=["onClick"],B={__name:"index",props:{target:{type:Object,default:null},targetKey:{type:String,default:""}},emits:["enterImg"],setup(e,{expose:C,emit:B}){const I=c(""),E=c(""),F=c({}),K=c(1),T=c(0),q=c(20),M=e=>{q.value=e,G()},W=e=>{K.value=e,G()},X=c(!1),A=c([]),D=c("/api/"),G=()=>r(this,null,(function*(){const e=yield u(((e,r)=>{for(var o in r||(r={}))l.call(r,o)&&n(e,o,r[o]);if(a)for(var o of a(r))t.call(r,o)&&n(e,o,r[o]);return e})({page:K.value,pageSize:q.value},F.value));0===e.code&&(A.value=e.data.list,T.value=e.data.total,K.value=e.data.page,q.value=e.data.pageSize,X.value=!0)})),H=e=>r(this,null,(function*(){_.prompt("请输入文件名或者备注","编辑",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"不能为空",inputValue:e.name}).then((a=>r(this,[a],(function*({value:a}){e.name=a;0===(yield s(e)).code&&(j({type:"success",message:"编辑成功!"}),G())})))).catch((()=>{j({type:"info",message:"取消修改"})}))}));return C({open:G}),(a,l)=>{const t=d("el-input"),n=d("el-form-item"),r=d("el-button"),u=d("el-form"),s=d("el-icon"),c=d("el-image"),C=d("el-pagination"),_=d("el-drawer");return p(),v(_,{modelValue:X.value,"onUpdate:modelValue":l[3]||(l[3]=e=>X.value=e),title:"媒体库",size:"650px"},{default:g((()=>[y(m,{title:"点击“文件名/备注”可以编辑文件名或者备注内容。"}),f("div",k,[y(o,{imageCommon:E.value,"onUpdate:imageCommon":l[0]||(l[0]=e=>E.value=e),class:"upload-btn-media-library",onOnSuccess:G},null,8,["imageCommon"]),y(i,{imageUrl:I.value,"onUpdate:imageUrl":l[1]||(l[1]=e=>I.value=e),"file-size":512,"max-w-h":1080,class:"upload-btn-media-library",onOnSuccess:G},null,8,["imageUrl"]),y(u,{ref:"searchForm",inline:!0,model:F.value},{default:g((()=>[y(n,{label:""},{default:g((()=>[y(t,{modelValue:F.value.keyword,"onUpdate:modelValue":l[2]||(l[2]=e=>F.value.keyword=e),class:"keyword",placeholder:"请输入文件名或备注"},null,8,["modelValue"])])),_:1}),y(n,null,{default:g((()=>[y(r,{size:"small",type:"primary",icon:"search",onClick:G},{default:g((()=>[z])),_:1})])),_:1})])),_:1},8,["model"])]),f("div",O,[(p(!0),b(w,null,h(A.value,((a,l)=>(p(),b("div",{key:l,class:"media-box"},[f("div",S,[(p(),v(c,{key:l,src:a.url&&"http"!==a.url.slice(0,4)?D.value+a.url:a.url,onClick:l=>{return t=a.url,n=e.target,r=e.targetKey,n&&r&&(n[r]=t),B("enterImg",t),void(X.value=!1);var t,n,r}},{error:g((()=>[f("div",U,[y(s,null,{default:g((()=>[V])),_:1})])])),_:2},1032,["src","onClick"]))]),f("div",{class:"img-title",onClick:e=>H(a)},x(a.name),9,P)])))),128))]),y(C,{"current-page":K.value,"page-size":q.value,total:T.value,style:{"justify-content":"center"},layout:"total, prev, pager, next, jumper",onCurrentChange:W,onSizeChange:M},null,8,["current-page","page-size","total"])])),_:1},8,["modelValue"])}}};export{B as _};
